
#!name=补充配置
#!desc=Apple News、Tik Tok本地化
[Rule]
#Apple News 本地化
DOMAIN,apple.comscoreresearch.com,Proxy
DOMAIN,gateway.icloud.com,,Proxy
DOMAIN,gspe1-ssl.ls.apple.com,Proxy
DOMAIN,news-assets.apple.com,Proxy
DOMAIN,news-client-search.apple.com,Proxy
DOMAIN,news-client.apple.com,Proxy
DOMAIN,news-edge.apple.com,Proxy
DOMAIN,news-events.apple.com,Proxy
DOMAIN-SUFFIX,apple.news,Proxy
DOMAIN,gspe1-ssl.ls.apple.com,PROXY

#TikTok解锁
DOMAIN-SUFFIX,byteoversea.com,Proxy
DOMAIN-SUFFIX,ibytedtos.com,Proxy
DOMAIN-SUFFIX,ipstatp.com,Proxy
DOMAIN-SUFFIX,muscdn.com,Proxy
DOMAIN-SUFFIX,musical.ly,Proxy
DOMAIN-SUFFIX,tik-tokapi.com,Proxy
DOMAIN-SUFFIX,tiktok.com,Proxy
DOMAIN-SUFFIX,tiktokcdn.com,Proxy
DOMAIN-SUFFIX,tiktokv.com,Proxy
DOMAIN-KEYWORD,-tiktokcdn-com,Proxy
# YouTube去广告
DOMAIN-SUFFIX,ads.youtube.com,REJECT
DOMAIN-SUFFIX,azabu-u.ac.jp,REJECT
DOMAIN-SUFFIX,couchcoaster.jp,REJECT
DOMAIN-SUFFIX,delivery.dmkt-sp.jp,REJECT
DOMAIN-SUFFIX,ehg-youtube.hitbox.com,REJECT
DOMAIN-SUFFIX,m-78.jp,REJECT
DOMAIN-SUFFIX,nichibenren.or.jp,REJECT
DOMAIN-SUFFIX,nicorette.co.kr,REJECT
DOMAIN-SUFFIX,ssl-youtube.2cnt.net,REJECT
DOMAIN-SUFFIX,youtube.112.2o7.net,REJECT
DOMAIN-SUFFIX,youtube.2cnt.net,REJECT
[URL Rewrite]
# YouTube去广告
# ======= 通用请求 ======= #
^https?:\/\/.+\.googlevideo\.com\/.+&oad -Reject
^https?:\/\/.+\.googlevideo\.com\/.+ctier ,Reject
^https?:\/\/youtubei\.googleapis\.com\/youtubei\/.+ad_ -Reject
^https?:\/\/youtubei\.googleapis\.com\/youtubei\/.+log_ -Reject
^https?:\/\/.+\.youtube\.com\/get_midroll_ ,reject
^https?:\/\/premiumyva\.appspot\.com\/vmclickstoadvertisersite -Reject
^https?:\/\/.+\.youtube\.com\/api\/stats\/ads -Reject
^https?:\/\/.+\.youtube\.com\/api\/stats\/.+adformat -Reject
^https?:\/\/.+\.youtube\.com\/pagead\/ -Reject
^https?:\/\/.+\.youtube\.com\/ptracking -Reject
^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v\d\/player\/ad_break -Reject
^https?:\/\/(www|s)\.youtube\.com\/api\/stats\/ads  -reject
^https?:\/\/(www|s)\.youtube\.com\/(pagead|ptracking) -Reject
^https?:\/\/s\.youtube\.com\/api\/stats\/qoe\?adcontext  -Reject

#TikTok解锁
(?<=_region=)CN(?=&) JP 307
(?<=&mcc_mnc=)4 2 307
^(https?:\/\/(tnc|dm)[\w-]+\.\w+\.com\/.+)(\?)(.+) $1$3 302
(^https?:\/\/*\.\w{4}okv.com\/.+&.+)(\d{2}\.3\.\d)(.+) $118.0$3 302

# ======= 视频广告 ======= #
(^https?:\/\/[\w-]+\.googlevideo\.com\/(?!dclk_video_ads).+?)&ctier=L(&.+?),ctier,(.+)  302 $1$2$3
^https?:\/\/[\w-]+\.googlevideo\.com\/(?!(dclk_video_ads|videoplayback\?)).+&oad -Reject

[Script]
# ======= 贴片广告 ======= #
youtube-player = type=http-response,pattern=^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/player,requires-body=1,binary-body-mode=1,max-size=0,script-path=https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/youtube-player.js
youtube-fake = type=http-response,pattern=^https?:\/\/[\w-]+\.googlevideo\.com\/initplayback.+&oad,requires-body=0,script-path=https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/youtube-fake.js
youtube-proto = type=http-response,pattern=^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/(browse|next)\?,requires-body=1,binary-body-mode=1,max-size=0,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/youtube.js
youtube-player = type=http-response,pattern=^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/player,requires-body=1,binary-body-mode=1,max-size=0,script-path=https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/youtube-player.js
youtube-fake = type=http-response,pattern=^https?:\/\/[\w-]+\.googlevideo\.com\/initplayback.+&oad,requires-body=0,script-path=https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/youtube-fake.js

#TikTok解锁
TikTok解锁= type=http-response,script-path=https://raw.githubusercontent.com/jinchenwuheikeji/Quantumult_X/master/tiktok.js, pattern=https?:\/\/.*\.tiktokv\.com\/aweme\/v\d\/(feed|mix\/aweme|aweme\/post|(multi\/)?aweme\/detail|follow\/feed|nearby\/feed|search\/item|general\/search\/single|hot\/search\/video\/list|aweme\/favorite) ,requires-body=1,max-size=0,timeout=10,enable=true

[MITM]
hostname = %APPEND%  -redirector*.googlevideo.com,*.googlevideo.com,www.youtube.com,s.youtube.com,youtubei.googleapis.com,*.tiktokv.com,*.byteoversea.com,*.tik-tokapi.com, -*snssdk.com, -*amemv.com

